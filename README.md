# Captcha Service

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –∫–∞–ø—á–∏ —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º —Å–ª–∞–π–¥–µ—Ä-–ø–∞–∑–ª–æ–º, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ Go –∏ gRPC —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π gRPC-Gateway –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è HTTP –∏ gRPC –Ω–∞ –æ–¥–Ω–æ–º –ø–æ—Ä—Ç—É.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose (–ü–†–ò–û–†–ò–¢–ï–¢–ù–´–ô)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± –∑–∞–ø—É—Å–∫–∞** - –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ:

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/ristoch/captcha.git
cd captcha

# 2. –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
docker-compose up -d

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps

# 4. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ (–≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã)
docker-compose logs -f

# 5. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs -f captcha-service-1
docker-compose logs -f balancer
docker-compose logs -f balancer-proxy

# 6. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose down

# 7. –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–≤–∫–ª—é—á–∞—è volumes)
docker-compose down --volumes --remove-orphans
```

**–ß—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- ‚úÖ **3 —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ captcha-service** (–ø–æ—Ä—Ç—ã 38000-38002) —Å gRPC-Gateway
- ‚úÖ **Balancer** (HTTP: 8080, gRPC: 9090) —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π
- ‚úÖ **Balancer-proxy** (–ø–æ—Ä—Ç 8081) –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ **Demo-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** (–ø–æ—Ä—Ç 8082) –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### üîß –ó–∞–ø—É—Å–∫ –≤—Ä—É—á–Ω—É—é (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** Go 1.24+, protobuf, –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
go mod download

# 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è protobuf —Ñ–∞–π–ª–æ–≤
protoc --go_out=gen/proto --go_opt=paths=source_relative \
       --go-grpc_out=gen/proto --go-grpc_opt=paths=source_relative \
       proto/captcha/captcha.proto proto/balancer/balancer.proto

# 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ (–≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö)
go run cmd/balancer/main.go          # –ë–∞–ª–∞–Ω—Å–µ—Ä
go run cmd/server/main.go            # Captcha-service
go run cmd/balancer-proxy/main.go    # –ü—Ä–æ–∫—Å–∏-–±–∞–ª–∞–Ω—Å–µ—Ä  
go run cmd/demo/main.go              # –î–µ–º–æ
```

## ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `docker-compose up -d` –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (–¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å 3 captcha-service)
curl http://localhost:8080/api/services | jq .

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü—ã
open http://localhost:8082

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
curl http://localhost:8082/health          # –î–µ–º–æ
curl http://localhost:8081/api/health      # –ü—Ä–æ–∫—Å–∏-–±–∞–ª–∞–Ω—Å–µ—Ä
curl http://localhost:8080/health          # –ë–∞–ª–∞–Ω—Å–µ—Ä
curl http://localhost:38000/health         # Captcha-service 1
curl http://localhost:38001/health         # Captcha-service 2
curl http://localhost:38002/health         # Captcha-service 3
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –í—Å–µ health-—á–µ–∫–∫–∏ –¥–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å `{"status":"ok"}`
- `/api/services` –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å 3 –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ UUID
- –î–µ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è –∏ –ø–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞–ø—á—É

## üåê –î–æ—Å—Ç—É–ø–Ω—ã–µ URL

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å—ã –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∞–¥—Ä–µ—Å–∞–º:

- **–î–µ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü–∞**: http://localhost:8082
- **–ü—Ä–æ–∫—Å–∏-–±–∞–ª–∞–Ω—Å–µ—Ä**: http://localhost:8081
- **–ë–∞–ª–∞–Ω—Å–µ—Ä**: http://localhost:8080 (HTTP) / localhost:9090 (gRPC)
- **–°–µ—Ä–≤–∏—Å—ã –∫–∞–ø—á–∏ (gRPC-Gateway)**: 
  - http://localhost:38000 (—ç–∫–∑–µ–º–ø–ª—è—Ä 1) - HTTP + gRPC –Ω–∞ –æ–¥–Ω–æ–º –ø–æ—Ä—Ç—É
  - http://localhost:38001 (—ç–∫–∑–µ–º–ø–ª—è—Ä 2) - HTTP + gRPC –Ω–∞ –æ–¥–Ω–æ–º –ø–æ—Ä—Ç—É
  - http://localhost:38002 (—ç–∫–∑–µ–º–ø–ª—è—Ä 3) - HTTP + gRPC –Ω–∞ –æ–¥–Ω–æ–º –ø–æ—Ä—Ç—É

## üéÆ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–µ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü—É
2. **–°–∏—Å—Ç–µ–º–∞** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∫–∞–ø—á—É-—Å–ª–∞–π–¥–µ—Ä
3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç —Å–ª–∞–π–¥–µ—Ä –¥–ª—è —Ä–µ—à–µ–Ω–∏—è
4. **–°–µ—Ä–≤–∏—Å** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

- **–Ø–∑—ã–∫**: Go 1.24+
- **–ü—Ä–æ—Ç–æ–∫–æ–ª**: gRPC + WebSocket + gRPC-Gateway
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: 100+ RPS –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–∞–¥–∞–Ω–∏–π
- **–ü–∞–º—è—Ç—å**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª—è 10k+ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –±–∞–ª–∞–Ω—Å–µ—Ä–µ —Å UUID
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
- **–ü–æ—Ä—Ç—ã**: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 38000-40000

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ cmd/                    # –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ internal/              # –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ service/           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ transport/         # HTTP/gRPC –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ infrastructure/    # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ templates/             # HTML —à–∞–±–ª–æ–Ω—ã –∫–∞–ø—á–∏
‚îú‚îÄ‚îÄ proto/                 # gRPC –ø—Ä–æ—Ç–æ–∫–æ–ª—ã
‚îî‚îÄ‚îÄ tests/                 # –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Docker-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–æ—Å–Ω–æ–≤–Ω–∞—è)
–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ `docker-compose.yml`:

```yaml
# –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ—Ä—Ç—ã
- "8080:8080"    # Balancer HTTP
- "8081:8081"    # Balancer-proxy
- "8082:8082"    # Demo
- "38000:38000"  # Captcha-service 1
- "38001:38001"  # Captcha-service 2  
- "38002:38002"  # Captcha-service 3

# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
PORT=38000-38002  # –ü–æ—Ä—Ç—ã –¥–ª—è captcha-service
BALANCER_ADDRESS=balancer:9090  # –ê–¥—Ä–µ—Å –±–∞–ª–∞–Ω—Å–µ—Ä–∞
```

### –õ–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# –ü–æ—Ä—Ç—ã
MIN_PORT=38000
MAX_PORT=40000

# –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
MAX_CHALLENGES=10000
COMPLEXITY_MEDIUM=50

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
MAX_ATTEMPTS=3
BLOCK_DURATION_MINUTES=5
```

### Docker-–æ—Ç–ª–∞–¥–∫–∞
```bash
# –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
docker-compose exec captcha-service-1 sh
docker-compose exec balancer sh

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
docker-compose exec captcha-service-1 env

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
docker network ls
docker network inspect captcha_captcha-network
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Docker-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# 1. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker-compose exec captcha-service-1 go test ./tests/integration/... -v

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose logs --tail=50

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose restart captcha-service-1

# 4. –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose build --no-cache
docker-compose up -d

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats
```

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
go test ./tests/integration/... -v

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤
curl http://localhost:8082/health          # –î–µ–º–æ
curl http://localhost:8081/api/health      # –ü—Ä–æ–∫—Å–∏-–±–∞–ª–∞–Ω—Å–µ—Ä
curl http://localhost:8080/health          # –ë–∞–ª–∞–Ω—Å–µ—Ä
curl http://localhost:38000/health         # –°–µ—Ä–≤–∏—Å –∫–∞–ø—á–∏ 1

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
curl http://localhost:8080/api/services    # –í—Å–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:

**–î–µ–º–æ (–ø–æ—Ä—Ç 8082):**
- `GET /` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /demo)
- `GET /demo` - –¥–µ–º–æ-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∫–∞–ø—á–µ–π
- `GET /health` - —Å—Ç–∞—Ç—É—Å –¥–µ–º–æ-—Å–µ—Ä–≤–∏—Å–∞
- `WebSocket /ws` - WebSocket –¥–ª—è –¥–µ–º–æ

**–ü—Ä–æ–∫—Å–∏-–±–∞–ª–∞–Ω—Å–µ—Ä (–ø–æ—Ä—Ç 8081):**
- `GET /api/health` - —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–∫—Å–∏
- `GET /api/memory` - –º–µ—Ç—Ä–∏–∫–∏ –ø–∞–º—è—Ç–∏
- `GET /api/stats` - –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `POST /api/services/add` - –¥–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å
- `DELETE /api/services/remove` - —É–¥–∞–ª–∏—Ç—å —Å–µ—Ä–≤–∏—Å
- `POST /api/challenge` - —Å–æ–∑–¥–∞—Ç—å –∫–∞–ø—á—É
- `POST /api/validate` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ
- `WebSocket /ws` - —Å–æ–±—ã—Ç–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–ë–∞–ª–∞–Ω—Å–µ—Ä (–ø–æ—Ä—Ç 8080):**
- `GET /health` - —Å—Ç–∞—Ç—É—Å –±–∞–ª–∞–Ω—Å–µ—Ä–∞
- `GET /api/health` - —Å—Ç–∞—Ç—É—Å –±–∞–ª–∞–Ω—Å–µ—Ä–∞ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π)
- `GET /api/services` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**–°–µ—Ä–≤–∏—Å—ã –∫–∞–ø—á–∏ (–ø–æ—Ä—Ç—ã 38000-38002, gRPC-Gateway):**
- `GET /health` - —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
- `GET /memory` - –º–µ—Ç—Ä–∏–∫–∏ –ø–∞–º—è—Ç–∏
- `GET /stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
- `POST /api/challenge` - —Å–æ–∑–¥–∞—Ç—å –∫–∞–ø—á—É (HTTP)
- `POST /api/validate` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ (HTTP)
- `WebSocket /ws` - —Å–æ–±—ã—Ç–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **gRPC**: `NewChallenge`, `ValidateChallenge`, `MakeEventStream`

**–õ–æ–≥–∏**: `logs/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ–ø—ã—Ç–æ–∫
- Graceful shutdown —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π —Å–µ—Ä–≤–∏—Å–æ–≤
- –ë–∏–Ω–∞—Ä–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ UUID –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
- –ò–∑–æ–ª—è—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ —á–µ—Ä–µ–∑ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

## üÜï –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### v2.0.0 - gRPC-Gateway –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- ‚úÖ **gRPC-Gateway**: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ HTTP –∏ gRPC –Ω–∞ –æ–¥–Ω–æ–º –ø–æ—Ä—Ç—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- ‚úÖ **UUID –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ó–∞–º–µ–Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö ID –Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ UUID
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ `Stop()` —Å –æ—á–∏—Å—Ç–∫–æ–π —Ä–µ—Å—É—Ä—Å–æ–≤
- ‚úÖ **–¢—Ä–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞**: –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö captcha-service
- ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 38000-40000

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤
- Graceful shutdown —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üìù API

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–ø—á–∏
```bash
curl -X POST http://localhost:8081/api/challenge \
  -H "Content-Type: application/json" \
  -d '{"complexity": 50, "user_id": "test-user"}'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—à–µ–Ω–∏—è
```bash
curl -X POST http://localhost:8081/api/validate \
  -H "Content-Type: application/json" \
  -d '{"challenge_id": "slider_123", "answer": {"x": 100, "y": 50}}'
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏
```bash
curl http://localhost:8081/api/memory
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
curl http://localhost:8081/api/stats
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ gRPC-Gateway —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è captcha-service —á–µ—Ä–µ–∑ gRPC-Gateway
curl http://localhost:38000/health
curl http://localhost:38001/health
curl http://localhost:38002/health

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–ø—á–∏ —á–µ—Ä–µ–∑ gRPC-Gateway
curl -X POST http://localhost:38000/api/challenge \
  -H "Content-Type: application/json" \
  -d '{"complexity": 50, "user_id": "test-user"}'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
curl http://localhost:8080/api/services | jq .
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
curl http://localhost:8082/health          # –î–µ–º–æ
curl http://localhost:8081/api/health      # –ü—Ä–æ–∫—Å–∏-–±–∞–ª–∞–Ω—Å–µ—Ä  
curl http://localhost:8080/health          # –ë–∞–ª–∞–Ω—Å–µ—Ä
curl http://localhost:38000/health         # Captcha-service 1
curl http://localhost:38001/health         # Captcha-service 2
curl http://localhost:38002/health         # Captcha-service 3

# –ú–µ—Ç—Ä–∏–∫–∏ –ø–∞–º—è—Ç–∏
curl http://localhost:38000/memory
curl http://localhost:38001/memory
curl http://localhost:38002/memory
```

---
